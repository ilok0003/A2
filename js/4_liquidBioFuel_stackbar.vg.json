{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "data": {
    "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/data/liquid_biofeuls_production_capacities_processed.csv"
  },
  "hconcat":[

    { 
      "width": 650,
      "height": 400,
      "title": {
        "text": "Liquid Biofeuls Production Capacities in 2020",
        "fontSize": 16,
        "subtitle": " ",
        "align": "right",
        "dx":-50
      },
      "encoding": {
          "y": {
              "field": "GEO", 
              "type": "nominal", 
              "sort":"-x",
              "title":"", "axis": {"grid":false}},
          "x": {
          "field": "Value",
          "aggregate": "sum",
          "type": "quantitative",
          "title": "Production Capacity (thousand tonnes)", 
          "axis": {"grid":false}
          }
      },
      "transform": [
        {"filter": "datum.TIME==2020"},
        {"filter": {"not": {"field": "GEO", "equal": "Euro area - 19 countries  (from 2015)"}}},
        {"filter": {"not": {"field": "GEO", "equal": "European Union - 27 countries (from 2020)"}}}
      ],
      "layer":[
          {
              "data": {
                "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/data/liquid_biofeuls_production_capacities_processed.csv"
              },
              "transform": [
                {"filter": "datum.TIME==2020"},
                {"filter": {"not": {"field": "GEO", "equal": "Euro area - 19 countries  (from 2015)"}}},
                {"filter": {"not": {"field": "GEO", "equal": "European Union - 27 countries (from 2020)"}}}
              ],
              "mark": {"type": "bar", "cornerRadiusTopLeft": 3, "cornerRadiusTopRight": 3},
              "encoding": {
                
                "color": {"field": "SIEC", "type": "nominal", "title": "Liquid Biofuel","scale":{
                  "domain":["Pure biogasoline", "Pure biodiesels", "Pure bio jet kerosene", "Other liquid biofuels"],
                  "range":["#eedd88", "#77aadd", "#bbbbbb", "#ee8866"]
                }},
                "tooltip":[
                  {"field": "GEO", "type": "nominal", "title": "Country"},
                  {"field": "SIEC", "type": "nominal", "title": "Biofuel Type"},
                  {"field": "Value", "type": "quantitative", "title": "Production Capacity (Thousand tonnes)", "format":",.0f"}
                ]
              },
              "params": [{
                "name": "countrySelection",
                "value": [{"GEO": "European Union - 27 countries (from 2020)"}],
                "select": {
                  "type": "point",
                  "fields": ["GEO"]
                }
              },
              {
                "name":"legend_selector",
                "select":{"type":"point", "fields": ["SIEC"]},
                "bind": "legend"
              }
            ]
            },
        {
          "mark":{
            "type":"text",
            "align": "center",
            "baseline": "middle",
            "dx": 10,
            "fontSize": 11,
            "fontStyle":"italic"
          },
          "encoding": {
            "text":{"field":"Value", "aggregate":"sum", "type":"quantitative", "format": ".0f"},
            "color":{"value":"black"},
            "opacity":{
              "condition":{ "test": "datum.sum_Value < 700", "value":1}, "value":0
          }
        }
        },

        {
        
          "mark":{
            "type":"text",
            "align": "left",
            "fontSize": 12,
            "fontWeight":"lighter",
            "font": "Open Sans"
          },
          
          "encoding": {
            "text":{"value":["Germany accounts for 1/3 of ","Liquid Biofuel production capacity","in European Union region"]},
            "color":{"value":"grey"},
            "x":{"value":350},
            "y":{"value":50}
          }
        }
        

        
      ]
    },



    {
      "width": 250,
      "height": 400,
      "title": {
        "text": "Changes over the Years",
        "fontSize": 16,
        "subtitle": " ",
        "align": "center",
        "dx": -35
      }, 
      "encoding": {
        "x": {
          "field": "TIME",
          "type": "ordinal",
          "scale": {"padding": 0.5},
          "axis": {"grid":false},
          "title":"Year"
        },
        "y": {
          "field": "Value",
          "type": "quantitative", 
          "axis": {"grid":false},
          "title":"Production Capacity (thousand tonnes)"
        },
        "color": {"field": "SIEC", "type": "nominal"}
      },
      "transform": [
        {"filter": "datum.TIME==2020 || datum.TIME==2011"},
        {"filter": {"param": "legend_selector", "empty": true}},
        {"filter": {"param": "countrySelection", "empty": false}}
      ],
      "layer": [
        {
          "mark": "line"
        },
        {
          "mark": {"type": "point", "filled": true, "size":{"expr": "50"}}
        },
        {
          "transform": [
            {"filter": "datum.TIME == 2011"}
          ],
          "mark":{
            "type":"text",
            "align": "left",
            "baseline": "middle",
            "fontSize": 13,
            "limit": 110
          },
          
          "encoding": {
            "text":{"field":"GEO",  "type":"nominal"},
            "color":{"value":"black"},
            "x":{"value":50},
            "y":{"value":250}
          }
        }


      ]
    }
  ],
  "config": {
    "style": {
      "cell": {
        "stroke": "transparent"
      }
    }
  }
}