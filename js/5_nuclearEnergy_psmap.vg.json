{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 360,
    "height": 430,
    "title": {
      "text":"Nuclear Energy Production Capacity",
      "fontSize":16,
      "dx":-20
    }, 
    "params": [
      {
        "name": "year_selection",
        "value": 2020,
        "bind":{
            "input": "range",
            "min": 2012,
            "max": 2020,
            "step": 1,
            "name": "Year selection : "
        }
    }
    ],
    "projection": {"type": "equalEarth"},
    "layer": [
      {
        "data": {
          "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/map_js/europe.json",
          "format": {"type": "topojson", "feature": "ne_50m_admin_0_countries"}
        },
        "transform": [
              {
              "calculate": "datum.properties.NAME + ' not in European Union (EU)'",
              "as": "note"
              }
          ],
          "mark": {"type": "geoshape", "fill": "lightgray", "stroke": "white"},
          "encoding": {"tooltip": {"field": "note"}}
      },
      {
        "data": {
          "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/map_js/ocean.json",
          "format": {"type": "topojson", "feature": "ne_50m_ocean"}
        },
        "mark": {"type": "geoshape", "fill": "#edf8fb"}
      },
      {
        "data": {
          "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/data/nulear_energy_geo.csv"
        },
        "transform": [
          {
            "lookup": "GEO",
            "from": {
              "data": {
                "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/map_js/europe.json",
                "format":{"type": "topojson", "feature": "ne_50m_admin_0_countries"}
              },
              "key": "properties.NAME"
            },"as": "geo"
          },
          {"filter":"datum.TIME<2020 || datum.GEO != 'United Kingdom'"}
        ],
        "mark": {"type": "geoshape", "stroke": "white"},
        "encoding": {
          "shape":{"field":"geo", "type": "geojson"},
          "color": {
            "field": "Unit",
            "type": "nominal",
            "scale": {
              "type": "threshold",
              "range": ["#ccddaa"]
            },
            "legend":null
          },
          "tooltip": [
            {"field": "GEO", "type": "nominal", "title": "Country"}
          ]
        }
      },
  
      {
        "data": {
          "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/data/nulear_energy_geo.csv"
        },
        "mark": {"type": "circle", "tooltip": {"content": "data"}},
        "encoding": {
          "longitude": {"field": "Longitude", "type": "quantitative"},
          "latitude": {"field": "Latitude", "type": "quantitative"},
          "size": {
            "aggregate":"sum",
            "field": "Value",
            "type": "quantitative",
            "title": "Total Production (tonnes)",
            "scale": {"domain": [200, 2000], "rangeMin": 200, "rangeMax":2000},
            "legend":null
          },
          "tooltip":[
            {"field": "GEO", "type": "nominal", "title": "Country"},
            {"field": "Value", "type": "quantitative", "title": "Total Heavy Metal Production (tonnes)"}
          ]
        },
        "transform": [
          {"filter":"datum.GEO != 'United Kingdom'"},
          {"filter":"datum.Time==year_selection"},
          {"filter":"datum.Value>0"}

        ]
      },

      {
        "data": {
          "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/data/nulear_energy_geo.csv"
        },
          "mark":{
            "type":"text",
            "align": "left",
            "baseline": "middle",
            "dx": 10,
            "dy": -80,
            "fontSize": 30,
            "fontStyle": "italic",
            "fontWeight": "bold"
          },
          
          "encoding": {
            "longitude": {"field": "Longitude", "type": "quantitative"},
            "latitude": {"field": "Latitude", "type": "quantitative"},
            "text":{"field":"Time",  "type":"nominal"},
            "color":{"value":"grey"}
          },
          "transform": [
            {"filter":"datum.GEO=='Ireland'"},
            {"filter":"datum.Time==year_selection"}
          ]
    },

    {
      "data": {
        "url": "https://raw.githubusercontent.com/lllkl12/FIT3179_Submission/main/asgn2/data/nulear_energy_geo.csv"
      },
      "mark":{
        "type":"text",
        "align": "left",
        "baseline": "middle",
        "dx": -30,
        "dy": -20,
        "fontSize": 10
      },
      
      "encoding": {
        "longitude": {"field": "Longitude", "type": "quantitative"},
        "latitude": {"field": "Latitude", "type": "quantitative"},
        "text":{"field":"GEO",  "type":"nominal"},
        "color":{"value":"black"}
      },
      "transform": [
        {"filter":"datum.GEO != 'United Kingdom'"},
        {"filter":"datum.Time==year_selection"},
        {"filter":"datum.Value>0"}

      ]
    }
    ],
    "config": {
      "style": {
        "cell": {
          "stroke": "transparent"
        }
      }
    } 
  }